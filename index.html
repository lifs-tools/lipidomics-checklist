<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"/>
<script language="javascript">

var lipidomics_forms_content = [{"title": "Overall study design",
  "content": [
    {"label": "Title of the Study",
     "name": "study-title",
     "type": "text",
     "required": 1,
     "value": "a",
     "description": "To whom correspondence should be addressed?"
     },
    {"name": "workflow-type",
     "type": "hidden",
     "value": "di"
     },
    {"label": "Select your weapons",
     "name": "whatever",
     "type": "multiple",
     "required": 1,
     "choice": [
        {"name": "12345",
         "label": "This is the first item",
         "value": 1
         },
        {"name": "321",
         "label": "This is the second item",
         "value": 0
         },
        {"name": "32145",
         "label": "This is the third item",
         "value": 1
         },
        {"name": "321458",
         "label": "This is the third item",
         "value": 1
         },
        {"name": "321457",
         "label": "This is the third item",
         "value": 1
         },
        {"name": "321456",
         "label": "This is the third item",
         "value": 1
         },
        {"name": "321455",
         "label": "This is the third item",
         "value": 1
         },
        {"name": "321454",
         "label": "This is the third item",
         "value": 1
         },
        {"name": "321453",
         "label": "This is the third item",
         "value": 1
         },
        {"name": "321452",
         "label": "This is the third item",
         "value": 1
         },
        {"name": "321451",
         "label": "This is the third item",
         "value": 1
         },
        {"name": "3214521",
         "label": "This is the third item",
         "value": 1
         },
        {"name": "3214512",
         "label": "This is the third item",
         "value": 1
         },
        {"name": "3214522",
         "label": "This is the third item",
         "value": 1
         },
        {"name": "3214511",
         "label": "This is the third item",
         "value": 1
         }
     ],
     "description": "To whom correspondence should be addressed?"
     },
    {"label": "All for combo",
     "name": "mlp",
     "type": "select",
     "choice": [
        {"name": "mrait",
         "label": "This is the first item",
         "value": 0
         },
        {"name": "atl34",
         "label": "This is the second item",
         "value": 1
         },
        {"name": "upga",
         "label": "This is the third item",
         "value": 0
         }
     ],
     "description": "To whom correspondence should be addressed?",
     "condition": "32145=1"
     },
     {"label": "Title of the Study",
     "name": "study-title2",
     "type": "text",
     "required": 0,
     "value": "Foo",
     "description": "To whom correspondence should be addressed?"
     }
     
  ]
},{"title": "Internal standards",
  "content": [
    {"label": "The internal standards",
     "name": "allright",
     "type": "text",
     "required": 1,
     "value": "What are you talking about",
     "description": "To whom correspondence should be addressed?"
     },
    {"label": "Temparature",
     "name": "temp",
     "type": "number",
     "min": 1,
     "max": 20,
     "value": 5,
     "step": 1,
     "required": 1,
     "description": "What is your favorite temparature?",
     "condition": "workflow-type='di'"
     }
  ]
}
];


//lipidomics_forms_content = [{'title': 'Overall study design', 'content': [{'label': 'Title of the study', 'name': '145', 'type': 'text', 'required': 1, 'value': 'CerS2', 'description': ''}, {'label': 'Principle investigator', 'name': '196', 'type': 'text', 'required': 1, 'value': 'Federico Torta', 'description': 'Please specify the person / laboratory responsible for the data acquisition.'}, {'label': 'Institution', 'name': '197', 'type': 'text', 'required': 1, 'value': 'NUS', 'description': 'Please specify the institution where the data was acquired.'}, {'label': 'Corresponding Email', 'name': '200', 'type': 'text', 'required': 1, 'value': 'bchfdtt@nus.edu.sg', 'description': 'To whom correspondence should be addressed?'}, {'name': '156', 'type': 'hidden', 'value': 'sep'}, {'label': 'Is the workflow targeted or untargeted?', 'name': '3', 'type': 'select', 'required': 0, 'choice': [{'name': '3-1', 'label': 'Targeted', 'value': 1}, {'name': '3-2', 'label': 'Untargeted', 'value': 0}], 'description': ''}, {'label': 'Clinical', 'name': '6', 'type': 'select', 'required': 0, 'choice': [{'name': '6-1', 'label': 'Yes', 'value': 0}, {'name': '6-2', 'label': 'No', 'value': 1}], 'description': 'Is it clinical lipidomics, i.e. samples were analyzed related to a clinical question using a quantitative, validated method?'}]}, {'title': 'Preanalytics / Sample Material', 'content': []}, {'title': 'Lipid extraction', 'content': [{'label': 'Extraction method', 'name': '38', 'type': 'select', 'required': 0, 'choice': [{'name': '38-1', 'label': '1-phase system', 'value': 1}, {'name': '38-2', 'label': '2-phase system', 'value': 0}, {'name': '38-3', 'label': 'Solid-Phase Extraction', 'value': 0}, {'name': '38-4', 'label': 'Other', 'value': 0}], 'description': 'Which type of lipid extraction was applied?', 'condition': "156!='img'"}, {'label': 'Other extraction method', 'name': '39', 'type': 'text', 'required': 1, 'value': '', 'description': 'Which other extraction method was applied?', 'condition': '38-4=1'}, {'label': 'pH adjustment', 'name': '40', 'type': 'select', 'required': 0, 'choice': [{'name': '40-1', 'label': 'None', 'value': 1}, {'name': '40-2', 'label': 'Hydrochloric acid', 'value': 0}, {'name': '40-3', 'label': 'Citrate', 'value': 0}, {'name': '40-4', 'label': 'Ammonium formate', 'value': 0}], 'description': 'Was the pH adjusted for extraction? If yes, which buffer, acid/base was added?', 'condition': "156!='img'"}, {'label': '1-phase system', 'name': '42', 'type': 'select', 'required': 0, 'choice': [{'name': '42-1', 'label': 'Acetonitrile', 'value': 0}, {'name': '42-2', 'label': 'Isopropanol', 'value': 0}, {'name': '42-3', 'label': 'Methanol', 'value': 0}, {'name': '42-5', 'label': 'Ethanol', 'value': 0}, {'name': '42-7', 'label': 'Butanol', 'value': 0}, {'name': '42-6', 'label': 'Butanol/Methanol (1/1)', 'value': 1}, {'name': '42-9', 'label': 'Butanol/Methanol (3/1)', 'value': 0}, {'name': '42-4', 'label': 'Other', 'value': 0}], 'description': 'Type of 1-phase, i.e. organic solvent used for protein precipitation.', 'condition': '38-1=1'}, {'label': 'Other 1-phase system', 'name': '157', 'type': 'text', 'required': 1, 'value': '', 'description': 'Which other type 1-phase was used for protein precipitation?', 'condition': '42-4=1'}, {'label': '2-phase system', 'name': '43', 'type': 'select', 'required': 0, 'choice': [{'name': '43-1', 'label': 'Folch', 'value': 1}, {'name': '43-2', 'label': 'Bligh&Dyer', 'value': 0}, {'name': '43-3', 'label': 'MTBE', 'value': 0}, {'name': '43-5', 'label': 'BUME', 'value': 0}, {'name': '43-4', 'label': '2-step extraction', 'value': 0}, {'name': '43-6', 'label': 'Other', 'value': 0}], 'description': 'Type of 2-phase; for other include reference when available.', 'condition': '38-2=1'}, {'label': 'Other 2-phase system', 'name': '159', 'type': 'text', 'required': 1, 'value': '', 'description': 'Which other type 2-phase was used?', 'condition': '43-6=1'}, {'label': 'Solid-Phase Extraction', 'name': '41', 'type': 'select', 'required': 0, 'choice': [{'name': '41-1', 'label': 'Reverse-Phase', 'value': 1}, {'name': '41-2', 'label': 'Normal-Phase', 'value': 0}, {'name': '41-3', 'label': 'Ion Exchange', 'value': 0}, {'name': '41-5', 'label': 'Mixed Mode', 'value': 0}, {'name': '41-4', 'label': 'Other', 'value': 0}], 'description': 'Separation mode applied for SPE.', 'condition': '38-3=1'}, {'label': 'Other Solid-Phase Extraction', 'name': '195', 'type': 'text', 'required': 1, 'value': '', 'description': 'Which other solid-phase extraction was applied?', 'condition': '41-4=1'}, {'label': 'Were internal standards added prior extraction?', 'name': '44', 'type': 'select', 'required': 0, 'choice': [{'name': '44-1', 'label': 'Yes', 'value': 1}, {'name': '44-2', 'label': 'No', 'value': 0}], 'description': ''}]}, {'title': 'Analytical platform', 'content': [{'label': 'Number of separation dimensions', 'name': '163', 'type': 'select', 'required': 0, 'choice': [{'name': '163-1', 'label': 'One dimension', 'value': 1}, {'name': '163-2', 'label': 'Two dimensions', 'value': 0}, {'name': '163-3', 'label': 'Three dimensions', 'value': 0}], 'description': 'How many dimensions were applied?', 'condition': "156='sep'"}, {'label': 'Separation Type 1', 'name': '164', 'type': 'select', 'required': 0, 'choice': [{'name': '164-1', 'label': 'GC', 'value': 0}, {'name': '164-2', 'label': 'LC', 'value': 1}, {'name': '164-3', 'label': 'SFC', 'value': 0}, {'name': '164-4', 'label': 'TLC', 'value': 0}], 'description': 'Which type of separation was applied?', 'condition': "156='sep'"}, {'label': 'Separation Mode 1', 'name': '165', 'type': 'select', 'required': 0, 'choice': [{'name': '165-1', 'label': 'NP', 'value': 0}, {'name': '165-2', 'label': 'HILIC', 'value': 0}, {'name': '165-3', 'label': 'RP', 'value': 1}], 'description': 'Which separation mode was applied?', 'condition': "156='sep'"}, {'label': 'Separation window (1) for lipid analyte selection (Â±) in minutes', 'name': '166', 'type': 'number', 'required': 1, 'value': '0.5', 'description': '', 'min': 0.0, 'condition': "156='sep'"}, {'label': 'Separation Type 2', 'name': '167', 'type': 'select', 'required': 0, 'choice': [{'name': '167-1', 'label': 'GC', 'value': 0}, {'name': '167-2', 'label': 'LC', 'value': 0}, {'name': '167-3', 'label': 'SFC', 'value': 0}, {'name': '167-4', 'label': 'TLC', 'value': 0}], 'description': 'Which type of separation was applied?', 'condition': '163-2=1|163-3=1'}, {'label': 'Separation Mode 2', 'name': '168', 'type': 'select', 'required': 0, 'choice': [{'name': '168-1', 'label': 'NP', 'value': 0}, {'name': '168-2', 'label': 'HILIC', 'value': 0}, {'name': '168-3', 'label': 'RP', 'value': 0}], 'description': 'Which separation mode was applied?', 'condition': '163-2=1|163-3=1'}, {'label': 'Separation window (2) for lipid analyte selection (Â±) in minutes', 'name': '169', 'type': 'number', 'required': 1, 'value': 0, 'description': '', 'min': 0.0, 'condition': '163-2=1|163-3=1'}, {'label': 'Separation Type 3', 'name': '170', 'type': 'select', 'required': 0, 'choice': [{'name': '170-1', 'label': 'GC', 'value': 0}, {'name': '170-2', 'label': 'LC', 'value': 0}, {'name': '170-3', 'label': 'SFC', 'value': 0}, {'name': '170-4', 'label': 'TLC', 'value': 0}], 'description': 'Which type of separation was applied?', 'condition': '163-3=1'}, {'label': 'Separation Mode 3', 'name': '171', 'type': 'select', 'required': 0, 'choice': [{'name': '171-1', 'label': 'NP', 'value': 0}, {'name': '171-2', 'label': 'HILIC', 'value': 0}, {'name': '171-3', 'label': 'RP', 'value': 0}], 'description': 'Which separation mode was applied?', 'condition': '163-3=1'}, {'label': 'Separation window (3) for lipid analyte selection (Â±) in minutes', 'name': '172', 'type': 'number', 'required': 1, 'value': 0, 'description': '', 'min': 0.0, 'condition': '163-3=1'}, {'label': 'RT verified by standard', 'name': '173', 'type': 'select', 'required': 0, 'choice': [{'name': '173-1', 'label': 'Yes', 'value': 1}, {'name': '173-2', 'label': 'No', 'value': 0}], 'description': 'Were standards used to check retention time of lipid class(species)?', 'condition': "156='sep'"}, {'label': 'CCS verified by standard', 'name': '174', 'type': 'select', 'required': 0, 'choice': [{'name': '174-1', 'label': 'Yes', 'value': 0}, {'name': '174-2', 'label': 'No', 'value': 1}], 'description': 'Were standards used to check CCS values?', 'condition': "156='sep'"}, {'label': 'Separation of isobaric/isomeric interferece confirmed', 'name': '175', 'type': 'select', 'required': 0, 'choice': [{'name': '175-1', 'label': 'Yes', 'value': 1}, {'name': '175-2', 'label': 'No', 'value': 0}], 'description': 'Was separation of isobaric/isomeric interferece confirmed by primary standards?', 'condition': "156='sep'"}, {'label': 'Model for separation prediction', 'name': '176', 'type': 'select', 'required': 0, 'choice': [{'name': '176-1', 'label': 'Yes', 'value': 0}, {'name': '176-2', 'label': 'No', 'value': 1}], 'description': 'Was a a model used to predict lipid molecule separation?', 'condition': "156='sep'"}, {'label': 'MS type', 'name': '160', 'type': 'select', 'required': 0, 'choice': [{'name': '160-6', 'label': 'Q', 'value': 0}, {'name': '160-7', 'label': 'TOF', 'value': 0}, {'name': '160-8', 'label': 'QQQ', 'value': 1}, {'name': '160-9', 'label': 'QTrap', 'value': 0}, {'name': '160-10', 'label': 'FTICR', 'value': 0}, {'name': '160-3', 'label': 'Orbitrap', 'value': 0}, {'name': '160-2', 'label': 'QTOF', 'value': 0}, {'name': '160-11', 'label': 'FTICR', 'value': 0}, {'name': '160-4', 'label': 'ICR', 'value': 0}, {'name': '160-5', 'label': 'Other', 'value': 0}], 'description': ''}, {'label': 'Other MS type', 'name': '60', 'type': 'text', 'required': 1, 'value': '', 'description': 'Specify another MS type.', 'condition': '160-5=1'}, {'label': 'MS vendor', 'name': '161', 'type': 'select', 'required': 0, 'choice': [{'name': '161-1', 'label': 'Agilent', 'value': 1}, {'name': '161-2', 'label': 'Bruker', 'value': 0}, {'name': '161-3', 'label': 'SCIEX', 'value': 0}, {'name': '161-6', 'label': 'Shimadzu', 'value': 0}, {'name': '161-5', 'label': 'Thermo', 'value': 0}, {'name': '161-4', 'label': 'Waters', 'value': 0}, {'name': '161-7', 'label': 'Other', 'value': 0}], 'description': 'Vendor of mass spectrometer.'}, {'label': 'Other MS vendor', 'name': '62', 'type': 'text', 'required': 1, 'value': '', 'description': 'Specify another MS vendor.', 'condition': '161-7=1'}, {'label': 'Ion source', 'name': '162', 'type': 'select', 'required': 0, 'choice': [{'name': '162-1', 'label': 'ESI', 'value': 1}, {'name': '162-2', 'label': 'APCI', 'value': 0}, {'name': '162-3', 'label': 'APPI', 'value': 0}, {'name': '162-4', 'label': 'MALDI', 'value': 0}, {'name': '162-5', 'label': 'Other', 'value': 0}], 'description': 'Which ion source was applied?'}, {'label': 'Other ion source', 'name': '64', 'type': 'text', 'required': 1, 'value': '', 'description': 'Specify another ion source.', 'condition': '162-5=1'}, {'label': 'Imaging ion source', 'name': '49', 'type': 'select', 'required': 0, 'choice': [{'name': '49-1', 'label': 'MALDI', 'value': 0}, {'name': '49-2', 'label': 'DESI', 'value': 0}, {'name': '49-3', 'label': 'Other', 'value': 0}], 'description': 'Which ion source was applied?', 'condition': "156='img'"}, {'label': 'Other imaging ion source', 'name': '57', 'type': 'text', 'required': 1, 'value': '', 'description': 'Specify another imaging ion source.', 'condition': '49-3=1'}, {'label': 'Direct type', 'name': '193', 'type': 'select', 'required': 0, 'choice': [{'name': '193-1', 'label': 'Syringe', 'value': 0}, {'name': '193-2', 'label': 'FIA', 'value': 0}, {'name': '193-3', 'label': 'Chip', 'value': 0}], 'description': 'Which inlet was used for direct MS?', 'condition': "156='di'"}, {'label': 'MS Level', 'name': '177', 'type': 'multiple', 'required': 1, 'choice': [{'name': '177-1', 'label': 'MS1', 'value': 0}, {'name': '177-3', 'label': 'MS2', 'value': 1}, {'name': '177-2', 'label': 'MSn', 'value': 0}], 'description': 'Which MS level(s) was(were) used for identification?'}, {'label': 'Mass resolution for detected ion at MS1', 'name': '181', 'type': 'select', 'required': 0, 'choice': [{'name': '181-1', 'label': 'Low resolution', 'value': 0}, {'name': '181-2', 'label': 'High resolution', 'value': 0}], 'description': 'Which mass resolution was applied for the detected ion?', 'condition': '177-1=1'}, {'label': 'Resolution in Da at MS1', 'name': '182', 'type': 'number', 'required': 1, 'value': 0, 'description': 'Specify the total window size in Da.', 'min': 0.0, 'condition': '177-1=1&181-1=1'}, {'label': 'Resolution at m/z 200 at MS1', 'name': '209', 'type': 'number', 'required': 1, 'value': 0, 'description': 'Specify the resolution at m/z 200 FWHM.', 'min': 0.0, 'condition': '177-1=1&181-2=1'}, {'label': 'Mass accuracy in ppm at MS1', 'name': '184', 'type': 'number', 'required': 1, 'value': 0, 'description': '', 'condition': '177-1=1&181-2=1'}, {'label': 'Mass window for precursor ion isolation (in  Da total isolation window)', 'name': '186', 'type': 'number', 'required': 1, 'value': '0.8', 'description': 'For MS2 and higher - which mass window was applied for precursor selection?', 'min': 0.0, 'condition': '177-2=1|177-3=1'}, {'label': 'Mass resolution for detected ion at MS2', 'name': '202', 'type': 'select', 'required': 0, 'choice': [{'name': '202-1', 'label': 'Low resolution', 'value': 1}, {'name': '202-2', 'label': 'High resolution', 'value': 0}], 'description': 'Which mass resolution was applied for the detected ion?', 'condition': '177-3=1'}, {'label': 'Resolution in Da at MS2', 'name': '203', 'type': 'number', 'required': 1, 'value': '0.8', 'description': 'Specify the total window size in Da.', 'min': 0.0, 'condition': '177-3=1&202-1=1'}, {'label': 'Resolution at m/z 200 at MS2', 'name': '208', 'type': 'number', 'required': 1, 'value': 0, 'description': 'Specify the resolution at m/z 200 FWHM.', 'min': 0.0, 'condition': '177-3=1&202-2=1'}, {'label': 'Mass accuracy in ppm at MS2', 'name': '206', 'type': 'number', 'required': 1, 'value': 0, 'description': '', 'condition': '177-3=1&202-2=1'}, {'label': 'Mass resolution for detected ion at MSn', 'name': '187', 'type': 'select', 'required': 0, 'choice': [{'name': '187-1', 'label': 'Low resolution', 'value': 0}, {'name': '187-2', 'label': 'High resolution', 'value': 0}], 'description': 'Which mass resolution was applied for the detected ion?', 'condition': '177-2=1'}, {'label': 'Resolution in Da at MSn', 'name': '188', 'type': 'number', 'required': 1, 'value': 0, 'description': 'Specify the total window size in Da.', 'min': 0.0, 'condition': '177-2=1&187-1=1'}, {'label': 'Resolution at m/z 200 at MSn', 'name': '189', 'type': 'number', 'required': 1, 'value': 0, 'description': 'Specify the resolution at m/z 200 FWHM.', 'min': 0.0, 'condition': '177-2=1&187-2=1'}, {'label': 'Mass accuracy in ppm at MSn', 'name': '192', 'type': 'number', 'required': 1, 'value': 0, 'description': '', 'min': 0.0, 'condition': '177-2=1&187-2=1'}, {'label': 'Additional dimension/techniques', 'name': '178', 'type': 'multiple', 'required': 0, 'choice': [{'name': '178-1', 'label': 'IMS', 'value': 0}, {'name': '178-2', 'label': 'OzID', 'value': 0}, {'name': '178-3', 'label': 'UV-PD', 'value': 0}, {'name': '178-4', 'label': 'Paterno-BÃ¼chi', 'value': 0}, {'name': '178-5', 'label': 'Other', 'value': 0}], 'description': 'Were additional analytical dimensions applied?'}, {'label': 'Other additional dimension/techniques', 'name': '180', 'type': 'text', 'required': 1, 'value': '', 'description': 'Which other additional dimension/technique was used?', 'condition': '178-5=1'}]}, {'title': 'Lipid identification / Additional separation method(s) / Additional analytical dimension / Lipid Quantification', 'content': []}, {'title': 'Quality control', 'content': [{'label': 'Blanks', 'name': '129', 'type': 'select', 'required': 0, 'choice': [{'name': '129-1', 'label': 'Yes', 'value': 0}, {'name': '129-2', 'label': 'No', 'value': 1}], 'description': 'Where blank samples analyzed?'}, {'label': 'Type of Blanks', 'name': '194', 'type': 'multiple', 'required': 1, 'choice': [{'name': '194-1', 'label': 'Extraction blank', 'value': 0}, {'name': '194-2', 'label': 'Injection blank', 'value': 0}], 'description': 'Which types of blank samples were analyzed?', 'condition': '129-1=1'}, {'label': 'Quality control', 'name': '131', 'type': 'select', 'required': 0, 'choice': [{'name': '131-1', 'label': 'Yes', 'value': 0}, {'name': '131-2', 'label': 'No', 'value': 1}], 'description': 'Were QC samples analyzed?'}, {'label': 'Type of QC sample', 'name': '132', 'type': 'multiple', 'required': 1, 'choice': [{'name': '132-2', 'label': 'Commercial sample', 'value': 0}, {'name': '132-3', 'label': 'Sample pool', 'value': 0}, {'name': '132-4', 'label': 'Reference material', 'value': 0}], 'description': 'Which types of QC samples were analyzed?', 'condition': '131-1=1'}]}, {'title': 'Method qualification and validation', 'content': [{'label': 'Method validation', 'name': '207', 'type': 'select', 'required': 0, 'choice': [{'name': '207-1', 'label': 'Yes', 'value': 0}, {'name': '207-2', 'label': 'No', 'value': 1}], 'description': 'Was any method validation performed?'}, {'label': 'Lipid recovery', 'name': '201', 'type': 'select', 'required': 0, 'choice': [{'name': '201-1', 'label': 'Yes', 'value': 0}, {'name': '201-2', 'label': 'No', 'value': 1}], 'description': 'Was the recovery of lipid extraction evaluated?', 'condition': '207-1=1'}, {'label': 'Dynamic quantification range', 'name': '134', 'type': 'select', 'required': 0, 'choice': [{'name': '134-1', 'label': 'Yes', 'value': 0}, {'name': '134-2', 'label': 'No', 'value': 1}], 'description': 'Was the dynamic range of the method evaluated?', 'condition': '207-1=1'}, {'label': 'Limit of quantitation (LOQ)/Limit of detection (LOD)', 'name': '137', 'type': 'select', 'required': 0, 'choice': [{'name': '137-1', 'label': 'Yes', 'value': 0}, {'name': '137-2', 'label': 'No', 'value': 1}], 'description': 'Was LOD/LOQ of the method evaluated?', 'condition': '207-1=1'}, {'label': 'Precison', 'name': '136', 'type': 'select', 'required': 0, 'choice': [{'name': '136-1', 'label': 'Yes', 'value': 0}, {'name': '136-2', 'label': 'No', 'value': 1}], 'description': 'Was precision of the method evaluated?', 'condition': '207-1=1'}, {'label': 'Accuracy', 'name': '135', 'type': 'select', 'required': 0, 'choice': [{'name': '135-1', 'label': 'Yes', 'value': 0}, {'name': '135-2', 'label': 'No', 'value': 1}], 'description': 'Was accuracy of the method evaluated?', 'condition': '207-1=1'}, {'label': 'Guidelines followed', 'name': '138', 'type': 'select', 'required': 0, 'choice': [{'name': '138-1', 'label': 'FDA', 'value': 0}, {'name': '138-2', 'label': 'EMA', 'value': 0}, {'name': '138-4', 'label': 'None', 'value': 1}, {'name': '138-3', 'label': 'Other', 'value': 0}], 'description': 'Was a guideline followed for method validation?', 'condition': '207-1=1'}, {'label': 'Other guidelines followed', 'name': '139', 'type': 'text', 'required': 1, 'value': '', 'description': 'Which other guidelines were followed?', 'condition': '138-3=1'}]}, {'title': 'Reporting', 'content': [{'label': 'Are reported raw data uploaded into repository?', 'name': '141', 'type': 'select', 'required': 0, 'choice': [{'name': '141-1', 'label': 'Yes', 'value': 0}, {'name': '141-2', 'label': 'No', 'value': 1}, {'name': '141-3', 'label': 'Available on request', 'value': 0}], 'description': 'Were reported data uploaded into repository or included as supplementary data?'}, {'label': 'Are metadata available?', 'name': '142', 'type': 'select', 'required': 0, 'choice': [{'name': '142-1', 'label': 'Yes', 'value': 0}, {'name': '142-2', 'label': 'No', 'value': 1}, {'name': '142-3', 'label': 'Available on request', 'value': 0}], 'description': '', 'condition': '141-1=1'}, {'label': 'Summary data', 'name': '144', 'type': 'multiple', 'required': 0, 'choice': [{'name': '144-1', 'label': 'Quantification data', 'value': 0}, {'name': '144-2', 'label': 'Identification data', 'value': 0}, {'name': '144-3', 'label': 'Quantification and identification data', 'value': 0}], 'description': 'Are summary, i.e. processed final data available?', 'condition': '141-1=1'}, {'label': 'Raw data upload', 'name': '143', 'type': 'select', 'required': 0, 'choice': [{'name': '143-1', 'label': 'Yes', 'value': 0}, {'name': '143-2', 'label': 'No', 'value': 1}, {'name': '143-3', 'label': 'Available on request', 'value': 0}], 'description': 'Are raw data, i.e. unprocessed data including peak m/z, intensities/areas, RT (when applicable) available?'}]}];


var field_map = {};
var dom_field_map = {};
var field_conditions = {};
var field_visible = {};
var form_pages = [];
var dom_form_pages = [];
var current_page = 0;
var required_messages = {};
var dom_text_fields = {};
var form_enabled = true;


function load_data(){
    field_map = {};
    dom_field_map = {};
    field_conditions = {};
    field_visible = {};
    form_pages = [];
    dom_form_pages = [];
    current_page = 0;
    required_messages = {};
    dom_text_fields = {};
    form_enabled = true;
    
    check_fields = {};
    for (page of lipidomics_forms_content){
        for (field of page["content"]){
            // add field info into field map
            if (!("type" in field) || !("name" in field)) continue;
            var field_name = field["name"];
            
            if (field_name in field_map){
                alert("Field with name \"" + field_name + "\" appears to be twice.");
                form_enabled = false;
            }
            field_map[field_name] = field;
            if ((field["type"] == "select" || field["type"] == "multiple") && ("choice" in field)){
                for (choice of field["choice"]){
                    if ("name" in choice){
                        var choice_name = choice["name"];
                        if (choice_name in field_map){
                            alert("Choice with name \"" + choice_name + "\" appears to be twice.");
                            form_enabled = false;
                        }
                        field_map[choice["name"]] = choice;
                    }
                }
            }
            
            // check for any logical conditions
            if (!("condition" in field) || field["condition"].length == 0) continue;
            
            check_fields[field_name] = [];
            var condition = [];
            for (condition_and of field["condition"].split("|")){
                var conjunction = [];
                for (con of condition_and.split("&")){
                    var single_condition = (con.search("!=") != -1) ? con.split("!=") : con.split("=");
                    
                    if (single_condition.length != 2){
                        alert("Corrupted condition \"" + field["condition"] + "\" in field \"" + field_name + "\".");
                        form_enabled = false;
                        continue;
                    }
                        
                    var key = single_condition[0];
                    var operator = "=";
                    var value = single_condition[1];
                        
                    var l = value.length;
                    
                    if (value[0] === "'" && value[l - 1] === "'"){
                        value = value.substring(1, l - 1);
                    }
                    else {
                        // check if value is a number
                        value = parseFloat(value);
                        if (isNaN(value)){
                            alert("Corrupted condition \"" + field["condition"] + "\" in field \"" + field_name + "\".");
                            form_enabled = false;
                            continue;
                        }
                    }
                    check_fields[field_name].push(key);
                    conjunction.push([key, operator, value]);
                    
                    
                }
                condition.push(conjunction);
            }
            field_conditions[field["name"]] = condition;
        }
    }
    // check if all required fields are actually present
    for (field_name in check_fields){
        if (!form_enabled) break;
        for (required_field of check_fields[field_name]){
            if (!(required_field in field_map)){
                alert("Error: required field \"" + required_field + "\" by field \"" + field_name + "\" is not in form.");
                form_enabled = false;
                break;
            }
        }
    }
    

    for (field_name in field_map){
        field_visible[field_name] = true;
    }
    
    var form_viewer = document.getElementById("form-viewer");
    var page_cnt = 0;
    for (page of lipidomics_forms_content){
        var obj_page = document.createElement("div");
        obj_page.className = "lipidomics-forms-page";
        dom_form_pages.push(obj_page);
        
        var forms_in_page = [];
        form_pages.push(forms_in_page);
        
        
        // Status decorator
        if (lipidomics_forms_content.length > 1){
            var obj_status = document.createElement("div");
            obj_status.className = "lipidomics-forms-status";
            obj_page.append(obj_status);
            
            var obj_status_text = document.createElement("div");
            obj_status_text.className = "lipidomics-forms-status-text";
            obj_status_text.innerHTML = "<font size='+1'>" + (("title" in page) ? page["title"] : "X") + " - Page " + (page_cnt + 1) + " of " + lipidomics_forms_content.length + "</font>";
            obj_status.append(obj_status_text);
            
            var obj_status_bar = document.createElement("div");
            obj_status_bar.className = "lipidomics-forms-status-bar";
            obj_status.append(obj_status_bar);
            
            var obj_status_bar_progress = document.createElement("div");
            obj_status_bar_progress.className = "lipidomics-forms-status-bar-progress";
            obj_status_bar_progress.style.width = ((page_cnt + 1) / lipidomics_forms_content.length * 100) + "%";
            obj_status_bar.append(obj_status_bar_progress);
        }
        
        
        for (field of page["content"]){
            if (!("type" in field) || !("name" in field)) continue;
            var field_name = field["name"];

            var obj = document.createElement("div");
            obj.className = "lipidomics-forms-field";
            dom_field_map[field_name] = obj;
            obj_page.append(obj);
            forms_in_page.push(field_name);
            
            if (field["type"] == "text"){
                if (!("label" in field)) continue;
                if (!("value" in field)) field["value"] = "";
                if (!("description" in field)) field["description"] = "";
                
                // Adding the title of the field
                var obj_title = document.createElement("div");
                obj_title.className = "lipidomics-forms-field-title";
                obj_title.innerHTML = "<b>" + field["label"] + "</b>";
                if (("required" in field) && field["required"] == 1){
                    obj_title.innerHTML += " <font color='red'>*</font>";
                }
                obj.append(obj_title);
                
                // Adding the text field of the field
                var obj_content = document.createElement("div");
                obj_content.className = "lipidomics-forms-field-content";
                var obj_input = document.createElement("input");
                obj_input.className = "lipidomics-forms-input";
                obj_input.type = "text";
                obj_input.value = field["value"];
                obj_input.content = field;
                obj_input.field_name = field_name;
                obj_input.setAttribute('onchange','update_text(this);');
                obj_content.append(obj_input);
                obj.append(obj_content);
                dom_text_fields[field_name] = obj_input;
                
                // Adding description of the field if present
                if (field["description"].length > 0){
                    var obj_description = document.createElement("div");
                    obj_description.className = "lipidomics-forms-field-description";
                    obj_description.innerHTML = field["description"];
                    obj.append(obj_description);
                }
                
                var obj_required = document.createElement("div");
                obj_required.className = "lipidomics-forms-required-message";
                obj_required.innerHTML = "This field is required.";
                obj_required.style.display = "none";
                obj.append(obj_required);
                required_messages[field_name] = obj_required;
            }
            
            if (field["type"] == "number"){
                if (!("label" in field)) continue;
                if (!("value" in field)) field["value"] = "";
                if (!("description" in field)) field["description"] = "";
                
                // Adding the title of the field
                var obj_title = document.createElement("div");
                obj_title.className = "lipidomics-forms-field-title";
                obj_title.innerHTML = "<b>" + field["label"] + "</b>";
                if (("required" in field) && field["required"] == 1){
                    obj_title.innerHTML += " <font color='red'>*</font>";
                }
                obj.append(obj_title);
                
                // Adding the text field of the field
                var obj_content = document.createElement("div");
                obj_content.className = "lipidomics-forms-field-content";
                var obj_input = document.createElement("input");
                obj_input.className = "lipidomics-forms-number";
                obj_input.type = "number";
                obj_input.value = field["value"];
                if ("min" in field) obj_input.min = field["min"];
                if ("max" in field) obj_input.min = field["max"];
                if ("step" in field) obj_input.min = field["step"];
                obj_input.content = field;
                obj_input.field_name = field_name;
                obj_input.setAttribute('onchange','update_number(this);');
                obj_content.append(obj_input);
                obj.append(obj_content);
                dom_text_fields[field_name] = obj_input;
                
                // Adding description of the field if present
                if (field["description"].length > 0){
                    var obj_description = document.createElement("div");
                    obj_description.className = "lipidomics-forms-field-description";
                    obj_description.innerHTML = field["description"];
                    obj.append(obj_description);
                }
                
                var obj_required = document.createElement("div");
                obj_required.className = "lipidomics-forms-required-message";
                obj_required.innerHTML = "This field is required.";
                obj_required.style.display = "none";
                obj.append(obj_required);
                required_messages[field_name] = obj_required;
            }
            
            else if (field["type"] == "multiple"){
                if (!("label" in field) || !("choice" in field)) continue;
                if (!("description" in field)) field["description"] = "";
                
                
                // Adding the title of the field
                var obj_title = document.createElement("div");
                obj_title.className = "lipidomics-forms-field-title";
                obj_title.innerHTML = "<b>" + field["label"] + "</b>";
                if (("required" in field) && field["required"] == 1){
                    obj_title.innerHTML += " <font color='red'>*</font>";
                }
                obj.append(obj_title);
                
                // Adding the checkbox fields of the field
                var obj_content = document.createElement("div");
                obj_content.className = "lipidomics-forms-field-content";
                var obj_ul = document.createElement("ul");
                obj_ul.className = "lipidomics-forms-multiple";
                for (choice of field["choice"]){
                    if (!("name" in choice)) continue;
                    if (!("label" in choice)) choice["label"] = "Null";
                    if (!("value" in choice)) choice["value"] = 0;
                    
                    var obj_li = document.createElement("ul");
                    obj_ul.append(obj_li);
                    obj_li.className = "lipidomics-forms-li";
                    
                    var obj_input = document.createElement("input");
                    obj_li.append(obj_input);
                    
                    obj_input.type = "checkbox";
                    obj_input.content = choice;
                    obj_input.field_name = field_name;
                    if (choice["value"] == 1) obj_input.checked = true;
                    obj_input.setAttribute('onchange','update_choice(this);');
                    
                    var obj_label = document.createElement("label");
                    obj_li.append(obj_label);
                    obj_label.innerHTML = choice["label"];
                    
                }
                obj_content.append(obj_ul);
                obj.append(obj_content);
                
                // Adding description of the field if present
                if (field["description"].length > 0){
                    var obj_description = document.createElement("div");
                    obj_description.className = "lipidomics-forms-field-description";
                    obj_description.innerHTML = field["description"];
                    obj.append(obj_description);
                }
                
                var obj_required = document.createElement("div");
                obj_required.className = "lipidomics-forms-required-message";
                obj_required.innerHTML = "This field is required.";
                obj_required.style.display = "none";
                obj.append(obj_required);
                required_messages[field_name] = obj_required;
            }
            
            else if (field["type"] == "select"){
                if (!("label" in field) || !("choice" in field)) continue;
                if (!("description" in field)) field["description"] = "";
                
                
                // Adding the title of the field
                var obj_title = document.createElement("div");
                obj_title.className = "lipidomics-forms-field-title";
                obj_title.innerHTML = "<b>" + field["label"] + "</b>";
                if (("required" in field) && field["required"] == 1){
                    obj_title.innerHTML += " <font color='red'>*</font>";
                }
                obj.append(obj_title);
                
                // Adding the checkbox fields of the field
                var obj_content = document.createElement("div");
                obj_content.className = "lipidomics-forms-field-content";
                var obj_select = document.createElement("select");
                obj_select.className = "lipidomics-forms-select";
                obj_select.content = field;
                obj_select.field_name = field_name;
                var selectedIndex = 0;
                var cnt = 0;
                for (choice of field["choice"]){
                    if (!("name" in choice)) continue;
                    if (!("label" in choice)) choice["label"] = "Null";
                    if (!("value" in choice)) choice["value"] = 0;
                    
                    var obj_option = document.createElement("option");
                    obj_select.append(obj_option);
                    if (choice["value"] == 1) selectedIndex = cnt;
                    
                    obj_option.innerHTML = choice["label"];
                    cnt++;
                }
                obj_select.selectedIndex = selectedIndex;
                obj_select.setAttribute('onchange','update_select(this);');
                obj_content.append(obj_select);
                obj.append(obj_content);
                
                
                // Adding description of the field if present
                if (field["description"].length > 0){
                    var obj_description = document.createElement("div");
                    obj_description.className = "lipidomics-forms-field-description";
                    obj_description.innerHTML = field["description"];
                    obj.append(obj_description);
                }
                
                var obj_required = document.createElement("div");
                obj_required.className = "lipidomics-forms-required-message";
                obj_required.innerHTML = "This field is required.";
                obj_required.style.display = "none";
                obj.append(obj_required);
                required_messages[field_name] = obj_required;
            }
        }
        obj_page.style.display = (page_cnt == 0) ? "block" : "none";
            
        if (page_cnt > 0){ 
            var obj_prev = document.createElement("button");
            obj_prev.className = "submit-button";
            obj_prev.disabled = !form_enabled;
            obj_prev.innerHTML = "Previous & Save";
            obj_prev.setAttribute('onclick','change_page(-1);');
            obj_page.append(obj_prev);
        }
            
        var obj_next = document.createElement("button");
        obj_next.className = "submit-button";
        obj_next.disabled = !form_enabled;
        if (page_cnt < lipidomics_forms_content.length - 1){
            obj_next.innerHTML = "Next & Save";
            obj_next.setAttribute('onclick','change_page(1);');
        }
        else {
            obj_next.innerHTML = "Submit";
            obj_next.setAttribute('onclick','submit_form();');
        }
        obj_page.append(obj_next);
        
        form_viewer.append(obj_page);
        
        page_cnt++;
    }
    check_conditions();
    change_page(0);
}





function update_text(form){
    if (!form_enabled) return;
    
    var field_name = form.content["name"];
    form.content["value"] = form.value;
    required_messages[field_name].style.display = "none";
    form.style.border = "1px solid #ccc";
    check_conditions();
}


function update_number(form){
    if (!form_enabled) return;
    
    var field_name = form.content["name"];
    form.content["value"] = form.value;
    required_messages[field_name].style.display = "none";
    required_messages[field_name].innerHTML = "This field is required.";
    form.style.border = "1px solid #ccc";
    check_conditions();
}



                
function update_choice(form){
    if (!form_enabled) return;
    
    var field_name = form.field_name;
    form.content["value"] = form.checked ? 1 : 0;
    required_messages[field_name].style.display = "none";
    check_conditions();
}



function update_select(form){
    if (!form_enabled) return;
    
    var field_name = form.content["name"];
    var l = form.content["choice"].length;
    for (var i = 0; i < l; ++i){
        form.content["choice"][i]["value"] = (i == form.selectedIndex) ? 1 : 0;
    }
    required_messages[field_name].style.display = "none";
    check_conditions();
}


function check_conditions(){
    if (!form_enabled) return;

    for (field_name in field_conditions){
        field_visible[field_name] = false;
        for (condition_and of field_conditions[field_name]){
            var condition_met = true;
            for (single_condition of condition_and){
                var key = single_condition[0];
                var operator = single_condition[1];
                var value = single_condition[2];
                condition_met &= (operator == "=" && field_map[key]["value"] == value) || (operator == "!=" && field_map[key]["value"] != value);
            }
            field_visible[field_name] |= condition_met;
        }
        dom_field_map[field_name].style.display = field_visible[field_name] ? "block" : "none";
    }
}


function check_requirements(){
    if (!form_enabled) return false;
    
    var first_required = null;
    for (form_name of form_pages[current_page]){
        var field = field_map[form_name];
        if (!("required" in field) || field["required"] == 0) continue;
        if (!field_visible[form_name]) continue;
        
        if (field["type"] == "text"){
            if (field["value"].length > 0) continue;
            
            dom_text_fields[form_name].style.border = "1px solid #cc0000";
        }
        else if (field["type"] == "multiple"){
            var something_selected = false;
            for (choice of field["choice"]){
                something_selected |= choice["value"] != 0;
            }
            if (something_selected) continue;
        }
        else if (field["type"] == "number"){
            var value = field["value"];
            if (typeof(value) != 'number'){
                if (value.length > 0){
                    value = parseFloat(value);
                    if (isNaN(value)){
                        required_messages[form_name].innerHTML = "Please check the correct format and use a point . as decimal sign.";
                        value = null;
                    }
                }
                else {
                    value = null;
                }
            }
            
            if (value != null){
                if ("min" in field && field["value"] < field["min"]){
                    required_messages[form_name].innerHTML = "Value must be at least '" + field["min"] + "'";
                }
                else if ("max" in field && field["max"] < field["value"]){
                    required_messages[form_name].innerHTML = "Value must be at most '" + field["max"] + "'";
                }
                else {
                    continue;
                }
            }
        }
        
        if (first_required == null) first_required = form_name;
        required_messages[form_name].style.display = "block";
    }
    
    // move to first required
    if (first_required != null){
        dom_field_map[first_required].scrollIntoView();
    }

    return first_required == null;
}


function change_page(offset){
    if (offset != 0 && !check_requirements()) return;

    current_page = Math.min(Math.max(current_page + offset, 0), lipidomics_forms_content.length - 1);
    var i = 0;
    for (page of dom_form_pages){
        page.style.display = (current_page == i++) ? "block" : "none";
    }
}

function submit_form(){
    if (!form_enabled) return;
    if (!check_requirements()) return;
}



</script>
<style>
.lipidomics-forms-page {
}

.lipidomics-forms-field {
    margin: 0 0 25px 0;
    width: 100%;
}

.lipidomics-forms-field-title {
    margin: 1px 0 1px 0;
}

.lipidomics-forms-field-content {
}

.lipidomics-forms-required-message {
    color: #990000;
}

.lipidomics-forms-input {
    padding: 6px 10px;
    max-width: 60%;
    border: 1px solid #ccc;
    border-radius: 2px;
    width: 100%;
}

.lipidomics-forms-number {
    padding: 6px 10px;
    max-width: 60%;
    border: 1px solid #ccc;
    border-radius: 2px;
    width: 100%;
}

.lipidomics-forms-li {
    padding: 6px 10px;
    max-width: 60%;
    width: 100%;
}

.lipidomics-forms-select {
    padding: 6px 10px;
    max-width: 60%;
    border: 1px solid #ccc;
    border-radius: 2px;
    width: 100%;
    text-transform: none;
    white-space: nowrap;
    background-color: #fff;
}

.lipidomics-forms-multiple {
    list-style: none;
    padding-left: 0;
    margin: 0px 0 0px 0;
}

.lipidomics-forms-field-description {
    font-size: 13px;
    margin: 1px 0 1px 0;
}

.submit-button {
    background-color: #ddd;
    border: 1px solid #ccc;
    cursor: pointer;
    font-size: 0.9em;
    font-weight: 400;
    margin: 0 5px;
    min-width: 90px;
    text-align: center;
    padding: 10px 15px;
}

.submit-button:hover {
    background-color: #eee;
}

.submit-button:active {
    background-color: #ccc;
}

.lipidomics-forms-status {
    margin: 0 0 30px 0;
}

.lipidomics-forms-status-bar {
    background-color: #ddd;
    height: 18px;
    border-radius: 10px;
    overflow: hidden;
    width: 100%;
    margin: 5px 0 0;
    padding: 0 0 0 0;
}

.lipidomics-forms-status-bar-progress {
    background-color: #009900;
    height: 18px;
    border-radius-left: 10px;
    overflow: hidden;
    position: relative;
    left: 0;
    top: 0;
}

</style>
</head>


<body>

<div id="form-viewer">
</div>


</body>
<script language="javascript">
load_data();
</script>
</html>
